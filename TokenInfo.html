<!DOCTYPE html>
<html>
<head>
    <title>Token Information</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>
<body>
    <div class="container mt-5">
        <h1>Token Information</h1>
        <hr>
        <div class="row">
            <div class="col-md-4">
                <h4>Token Contract Address:</h4>
            </div>
            <div class="col-md-8">
                <p id="contract-address"></p>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                <h4>Token Name:</h4>
            </div>
            <div class="col-md-8">
                <p id="token-name"></p>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                <h4>Token Symbol:</h4>
            </div>
            <div class="col-md-8">
                <p id="token-symbol"></p>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                <h4>Total Supply:</h4>
            </div>
            <div class="col-md-8">
                <p id="total-supply"></p>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                <h4>Decimals:</h4>
            </div>
            <div class="col-md-8">
                <p id="decimals"></p>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                <h4>Owner:</h4>
            </div>
            <div class="col-md-8">
                <p id="owner"></p>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">
                <h4>Balance:</h4>
            </div>
            <div class="col-md-8">
                <p id="balance"></p>
            </div>
        </div>

        <!-- Token Transactions -->
        <h1>Token Transactions</h1>
        <h2>Deposit</h2>
        <form>
            <label for="deposit-address">Recipient Address:</label>
            <input type="text" id="deposit-address" name="deposit-address" class="form-control">
            <label for="deposit-amount">Amount:</label>
            <input type="number" id="deposit-amount" name="deposit-amount" class="form-control">
            <button type="button" onclick="deposit()" class="btn btn-primary mt-2">Deposit</button>
        </form>

        <h2>Withdraw</h2>
        <form>
            <label for="withdraw-address">Recipient Address:</label>
            <input type="text" id="withdraw-address" name="withdraw-address" class="form-control">
            <label for="withdraw-amount">Amount:</label>
            <input type="number" id="withdraw-amount" name="withdraw-amount" class="form-control">
            <button type="button" onclick="withdraw()" class="btn btn-danger mt-2">Withdraw</button>
        </form>

        <h2>Transaction History</h2>
        <table id="transaction-table" class="table">
            <thead>
                <tr>
                    <th>From</th>
                    <th>To</th>
                    <th>Amount</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody>
                <!-- Transaction History will be dynamically populated here -->
            </tbody>
        </table>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.5.2/web3.min.js"></script>
    <script>
        // Set up Web3 and contract connection
        const web3 = new Web3(window.ethereum); // Using MetaMask provider
        const tokenContractAddress = '0xYourTokenAddress'; // Replace with your token contract address
        const tokenABI = [...] // Replace with actual ABI of your ERC20 token contract
        const tokenContract = new web3.eth.Contract(tokenABI, tokenContractAddress);

        // Elements for displaying token info
        const contractAddressElement = document.getElementById('contract-address');
        const tokenNameElement = document.getElementById('token-name');
        const tokenSymbolElement = document.getElementById('token-symbol');
        const totalSupplyElement = document.getElementById('total-supply');
        const decimalsElement = document.getElementById('decimals');
        const ownerElement = document.getElementById('owner');
        const balanceElement = document.getElementById('balance');

        // Display token information
        const displayTokenInfo = async () => {
            const [owner, name, symbol, totalSupply, decimals] = await Promise.all([
                tokenContract.methods.owner().call(),
                tokenContract.methods.name().call(),
                tokenContract.methods.symbol().call(),
                tokenContract.methods.totalSupply().call(),
                tokenContract.methods.decimals().call(),
            ]);

            contractAddressElement.textContent = tokenContractAddress;
            tokenNameElement.textContent = name;
            tokenSymbolElement.textContent = symbol;
            totalSupplyElement.textContent = web3.utils.fromWei(totalSupply, 'ether');
            decimalsElement.textContent = decimals;
            ownerElement.textContent = owner;
        };

        // Deposit function
        const deposit = async () => {
            const depositAddress = document.getElementById('deposit-address').value;
            const depositAmount = document.getElementById('deposit-amount').value;
            const accounts = await web3.eth.getAccounts();
            const sender = accounts[0];
            
            try {
                const tx = await tokenContract.methods.transfer(depositAddress, web3.utils.toWei(depositAmount, 'ether')).send({ from: sender });
                console.log('Deposit successful:', tx.transactionHash);
                addTransaction(sender, depositAddress, depositAmount, new Date().toISOString());
            } catch (error) {
                console.error('Error depositing tokens:', error);
            }
        };

        // Withdraw function
        const withdraw = async () => {
            const withdrawAddress = document.getElementById('withdraw-address').value;
            const withdrawAmount = document.getElementById('withdraw-amount').value;
            const accounts = await web3.eth.getAccounts();
            const sender = accounts[0];

            try {
                const tx = await tokenContract.methods.transfer(withdrawAddress, web3.utils.toWei(withdrawAmount, 'ether')).send({ from: sender });
                console.log('Withdraw successful:', tx.transactionHash);
                addTransaction(withdrawAddress, sender, withdrawAmount, new Date().toISOString());
            } catch (error) {
                console.error('Error withdrawing tokens:', error);
            }
        };

        // Add a transaction to the history table
        const addTransaction = (from, to, amount, date) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${from}</td>
                <td>${to}</td>
                <td>${amount}</td>
                <td>${date}</td>
            `;
            document.querySelector('#transaction-table tbody').appendChild(row);
        };

        // Initialize the token info on page load
        window.addEventListener('load', () => {
            displayTokenInfo();
        });
    </script>
</body>
</html>
